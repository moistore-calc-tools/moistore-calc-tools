<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>LEGEND OF YMIR ‚Äì DIAMOND üíé</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --txt:#fff7fb; --mut:#dbc9d0; --green:#21d072;
    --blue:#1877f2; --discord:#5865f2;
    --accent1:#ff1d5a; --accent2:#ff5c90;         /* theme accent */
    --spark1: rgba(255,90,140,1);                  /* sparkle color stops */
    --spark2: rgba(255,40,100,1);
    --border: rgba(255,80,120,.18);
    --glow: 0 0 18px rgba(255,30,80,.35), 0 0 28px rgba(255,30,80,.14);
  }
  *{box-sizing:border-box}

  html,body{height:100%;margin:0;color:var(--txt);font-family:Poppins,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:#0a0609;overflow-x:hidden}
  /* Animated dark red (themeable) background */
  body::before{
    content:"";position:fixed;inset:-10% -10%;z-index:-2;pointer-events:none;
    background:
      radial-gradient(40% 30% at 15% 8%, rgba(255,0,80,.12), transparent 60%),
      radial-gradient(35% 25% at 85% 0%, rgba(200,0,60,.08), transparent 65%),
      radial-gradient(45% 30% at 50% 110%, rgba(255,30,100,.08), transparent 70%);
    filter: blur(12px) saturate(115%); animation:bgFloat 14s ease-in-out infinite alternate;
  }
  @keyframes bgFloat{0%{transform:translate3d(0,0,0) scale(1)}50%{transform:translate3d(1%,-1%,0) scale(1.02)}100%{transform:translate3d(-1%,1%,0) scale(1.03)}}
  /* Sparkles */
  #sparkleCanvas{position:fixed; inset:0; z-index:-1; pointer-events:none}

  .wrap{max-width:760px;margin:auto;padding:14px 14px 80px; position:relative; z-index:1;}
  .title{display:flex;align-items:center;gap:10px;justify-content:center;font-weight:800;font-size:20px;letter-spacing:.4px;margin:2px 0 8px}

  /* Theme switcher */
  .toolbar{display:flex;gap:8px;justify-content:center;align-items:center;margin:6px 0 10px;flex-wrap:wrap}
  .chipBtn{border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06);padding:8px 12px;border-radius:999px;font-weight:800;cursor:pointer}
  .chipBtn.active{outline:2px solid rgba(255,255,255,.35)}

  /* LOGO (subtle ring, bigger image) */
  .logoWrap{display:grid;place-items:center;margin:6px 0 8px}
  .logo{width:min(44vw,190px);aspect-ratio:1/1;border-radius:999px;position:relative;display:grid;place-items:center;background:radial-gradient(120px 110px at 50% 50%, #0b070b 40%, #000 100%);box-shadow:0 0 0 8px rgba(0,0,0,.55)}
  .ring{position:absolute;inset:10px;border-radius:999px;background:conic-gradient(var(--accent1),var(--accent2),var(--accent1));filter:blur(.6px);-webkit-mask:radial-gradient(circle, transparent 61.5%, #000 63%);mask:radial-gradient(circle, transparent 61.5%, #000 63%);animation:spin 9s linear infinite;opacity:.55}
  @keyframes spin{to{transform:rotate(360deg)}}
  .logo img{width:82%;border-radius:999px;box-shadow:0 0 18px rgba(0,0,0,.35)}

  /* Promo banner */
  .promo{display:none;margin:8px 0;padding:10px 12px;border-radius:14px;font-weight:800;text-align:center;
         background:linear-gradient(180deg,#112015,#0b170f);border:1px solid rgba(40,255,160,.28);box-shadow:0 0 24px rgba(40,255,160,.18)}
  .promo b{color:#9dffd2}

  /* Controls row */
  .controls{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin:6px 0}
  .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;border:none;border-radius:14px;padding:12px 14px;font-weight:800;letter-spacing:.2px;cursor:pointer}
  .buy{background:var(--green);color:#092112;box-shadow:0 18px 44px rgba(33,208,114,.28)}
  .promoBtn{background:#1f8f53;color:#ecfff5}
  .endBtn{background:#532222;color:#ffdede}
  .btn[disabled]{opacity:.55;filter:grayscale(.25);cursor:not-allowed}

  /* Tier pills */
  .row{display:grid;gap:12px}
  .prices{grid-template-columns:repeat(3,1fr);margin:6px 0 10px}
  .pill{background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.00));border:1px solid var(--border);border-radius:18px;padding:12px;text-align:center;box-shadow:inset 0 0 0 1px rgba(255,30,80,.06), var(--glow);transition:transform .18s, box-shadow .18s, border-color .18s, opacity .18s}
  .pval{font-size:26px;font-weight:900}
  .ptxt{font-size:12px;color:var(--mut)}
  .pill.active{transform:translateY(-2px) scale(1.02);border-color:rgba(80,255,170,.55);box-shadow:0 0 22px rgba(40,255,170,.28), inset 0 0 0 1px rgba(40,255,170,.32);animation:bump .45s ease}
  @keyframes bump{0%{transform:scale(0.98)}40%{transform:scale(1.03)}100%{transform:scale(1.02)}}
  .pill.lock{opacity:.45;filter:grayscale(0.35);border-color:rgba(255,255,255,.12);box-shadow:none}

  /* Section + inputs */
  .section{background:linear-gradient(180deg,#160e14,#110c11);border:1px solid var(--border);border-radius:18px;padding:14px;box-shadow:var(--glow)}
  .label{font-size:13px;color:var(--mut);margin:4px 2px 6px}
  .in{width:100%;border:1px solid var(--border);background:#0b090c;color:#fff;padding:14px;border-radius:14px;font-size:18px;outline:none;box-shadow:inset 0 0 18px rgba(255,10,60,.06), 0 0 14px rgba(255,40,100,.12)}
  .in:focus{border-color:#ff6aa1;box-shadow:0 0 0 3px rgba(255,60,110,.18), var(--glow)}
  .warn{margin-top:8px;font-size:12px;color:#ff7b94;display:none}

  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:10px}
  .box{background:linear-gradient(180deg,#1a1218,#120e13);border:1px solid var(--border);border-radius:16px;padding:12px;text-align:center;box-shadow:var(--glow)}
  .box h5{margin:0 0 4px;font-size:12px;color:var(--mut)}
  .rateOut{font-weight:900;font-size:20px}
  .saveOut{font-weight:900;font-size:20px;color:#c9ffe0}
  .saveBox{background:linear-gradient(180deg,#0f2117,#0a1a11);border-color:rgba(40,255,160,.28)}

  /* Payment + socials */
  .pay{background:linear-gradient(180deg,#11111a,#0b0c12);border:1px solid rgba(24,119,242,.22);border-radius:18px;padding:12px 14px;box-shadow:0 0 22px rgba(24,119,242,.16)}
  .gcash{display:flex;align-items:center;gap:10px;font-weight:800;background:rgba(24,119,242,.10);border:1px solid rgba(24,119,242,.35);padding:10px 12px;border-radius:12px}
  .soc{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
  .fb{background:var(--blue);color:#fff}
  .dc{background:var(--discord);color:#fff}

  /* Completed + Transactions */
  .ctCard{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center;margin-top:10px;background:linear-gradient(180deg,#101510,#0c100c);border:1px solid rgba(80,255,120,.22);border-radius:18px;padding:10px 12px;box-shadow:0 0 22px rgba(20,255,120,.12)}
  .completed{background:#1f8f53;color:#ecfff5}
  .chip{display:flex;align-items:center;gap:8px;background:#0b1310;border:1px solid rgba(80,255,120,.25);padding:10px 14px;border-radius:12px;font-weight:900}
  .num{font-size:20px}

  /* Popup + QR modal */
  .popup{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;place-items:center;z-index:50}
  .cardPop{width:min(92vw,520px);background:#0f0d10;border:1px solid var(--border);border-radius:18px;padding:18px;text-align:center}
  .close{background:#272327;color:#fff;border:none;border-radius:12px;padding:10px 14px;font-weight:800}
  .qrImg{max-width:92vw;max-height:80vh;border-radius:12px;border:1px solid rgba(255,255,255,.16);box-shadow:0 0 22px rgba(0,0,0,.35)}

  @media (max-width:540px){
    .prices{grid-template-columns:repeat(3,1fr)}
    .controls{grid-template-columns:1fr 1fr}
    .grid2{grid-template-columns:1fr 1fr}
  }
</style>
</head>
<body>
  <!-- Sparkles -->
  <canvas id="sparkleCanvas"></canvas>

  <div class="wrap">
    <div class="title">LEGEND OF YMIR DIAMOND üíé</div>

    <!-- Theme switcher -->
    <div class="toolbar">
      <button class="chipBtn" data-theme="red">üî¥ Red</button>
      <button class="chipBtn" data-theme="purple">üü£ Purple</button>
      <button class="chipBtn" data-theme="blue">üîµ Ice Blue</button>
      <button class="chipBtn" data-theme="green">üü¢ Emerald</button>
    </div>

    <!-- LOGO -->
    <div class="logoWrap">
      <div class="logo">
        <div class="ring"></div>
        <img src="logo.png" alt="Logo">
      </div>
    </div>

    <!-- Promo banner -->
    <div id="promoBar" class="promo">üî• <b>PROMO ACTIVE:</b> All orders at <b>‚Ç±0.72 / dia</b> ‚Ä¢ Ends in <b id="promoLeft">--:--:--</b></div>

    <!-- Controls -->
    <div class="controls">
      <button id="startPromo" class="btn promoBtn">‚ú® Start 24h Promo ‚Ç±0.72</button>
      <button id="endPromo" class="btn endBtn">‚èπ End Promo</button>
    </div>

    <!-- Price pills (with mins) -->
    <div class="row prices">
      <div id="pill80" class="pill">
        <div class="pval">‚Ç±0.80</div>
        <div class="ptxt">min 1000 üíé</div>
      </div>
      <div id="pill75" class="pill">
        <div class="pval">‚Ç±0.75</div>
        <div class="ptxt">min 4000 üíé</div>
      </div>
      <div id="pill70" class="pill">
        <div class="pval">‚Ç±0.70</div>
        <div class="ptxt">min 8000 üíé</div>
      </div>
    </div>

    <!-- Inputs -->
    <div class="section">
      <div class="label">Enter Diamonds üíé</div>
      <input id="dias" class="in" inputmode="numeric" placeholder="e.g. 1500">
      <div class="label" style="margin-top:10px">ENTER PHP ‚Ç±</div>
      <input id="phpIn" class="in" inputmode="decimal" placeholder="e.g. 500.00">
      <div id="warn" class="warn">Minimum 1000 üíé required.</div>

      <div class="grid2">
        <div class="box">
          <h5>Rate</h5>
        <div id="rateOut" class="rateOut">‚Äî</div>
        </div>
        <div class="box saveBox">
          <h5>Save</h5>
          <div id="saveOut" class="saveOut">‚Äî</div>
        </div>
      </div>
    </div>

    <!-- Buy + Promo + QR -->
    <div class="controls">
      <button id="buyBtn" class="btn buy" disabled>üíé Buy (Copy + Messenger)</button>
      <button id="qrBtn" class="btn" style="background:#1877f2;color:#fff">üì∑ Scan QR</button>
    </div>

    <div class="label" style="text-align:center;margin-top:2px">Enter at least 1000 dias or PHP equivalent.</div>

    <!-- Payment + socials (icons) -->
    <div class="pay" style="margin-top:10px">
      <div class="gcash">
        <!-- Wallet + ‚Ç± icon -->
        <svg width="22" height="22" viewBox="0 0 24 24" aria-hidden="true">
          <rect x="2.8" y="6" width="18.4" height="12" rx="3" fill="#1877f2"/>
          <rect x="13.2" y="9" width="7" height="6" rx="1.4" fill="#0f5bd7"/>
          <circle cx="17.2" cy="12" r="1.2" fill="#fff"/>
          <text x="7.2" y="14.7" font-size="7.6" fill="#fff" font-family="Poppins, Arial" font-weight="700">‚Ç±</text>
        </svg>
        GCash ‚Ä¢ <strong>09162466318 ‚Äî MOISES B.</strong>
      </div>

      <div class="soc">
        <button id="fbBtn" class="btn fb">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="#fff" aria-hidden="true">
            <path d="M22 12.07C22 6.48 17.52 2 11.93 2S2 6.48 2 12.07c0 5.01 3.66 9.17 8.44 9.93v-7.02H7.9v-2.91h2.54V9.41c0-2.5 1.49-3.89 3.77-3.89 1.09 0 2.24.2 2.24.2v2.46h-1.26c-1.24 0-1.63.77-1.63 1.56v1.87h2.78l-.44 2.91h-2.34V22c4.78-.76 8.44-4.92 8.44-9.93z"/>
          </svg>
          Facebook Page
        </button>

        <button id="dcBtn" class="btn dc">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="#fff" aria-hidden="true">
            <path d="M20.3 4.4A16 16 0 0015.9 3l-.4.8a13.3 13.3 0 00-7 0L8.1 3A16 16 0 003.7 4.4C1.7 7.5 1 10.5 1.2 13.4a16 16 0 005.9 3l.8-1.3c-.4-.1-.7-.3-1-.4.1-.1.2-.2.3-.3 1.9.9 4 .9 5.9 0l.3.3c-.3.2-.6.3-1 .4l.8 1.3a16 16 0 005.9-3c.3-3-.5-5.9-2.8-9zM9.6 13c-.9 0-1.6-.8-1.6-1.7S8.7 9.6 9.6 9.6s1.6.8 1.6 1.7S10.5 13 9.6 13zm4.8 0c-.9 0-1.6-.8-1.6-1.7s.7-1.7 1.6-1.7 1.6.8 1.6 1.7-.7 1.7-1.6 1.7z"/>
          </svg>
          Discord Server
        </button>
      </div>
    </div>

    <!-- Completed + Global Transactions -->
    <div class="ctCard">
      <button id="doneBtn" class="btn completed">‚úÖ Completed</button>
      <div class="chip">Transactions <span id="txNum" class="num">0</span></div>
    </div>
  </div>

  <!-- BUY Popup -->
  <div id="buyPopup" class="popup">
    <div class="cardPop">
      <h3>Copied ‚úî</h3>
      <p><strong>I-PASTE MO ITO SA MESSENGER KO.</strong><br>We opened your Messenger chat.</p>
      <button id="closePop" class="close">OK</button>
    </div>
  </div>

  <!-- QR Modal -->
  <div id="qrModal" class="popup">
    <div class="cardPop">
      <img class="qrImg" src="gcash-qr.png" alt="GCash QR">
      <div style="margin-top:10px">
        <button id="closeQR" class="close">Close</button>
      </div>
    </div>
  </div>

<script>
  /* ===== CONFIG ‚Äî set your Messenger link (optional) =====
     Example: const MESSENGER_URL = 'https://m.me/your.username';
     If left '', we'll just open the Messenger app if available.
  */
  const MESSENGER_URL = ''; // <- put your chat link here if you want

  /* ===== Helpers ===== */
  const $ = id => document.getElementById(id);
  const num = v => parseFloat(String(v).replace(/[^0-9.]/g,'')) || 0;
  const int = v => parseInt(String(v).replace(/[^0-9]/g,'')) || 0;
  const F = n => Number(n).toLocaleString(undefined,{minimumFractionDigits:2, maximumFractionDigits:2});

  /* ===== THEME SWITCHER ===== */
  const THEME_KEY='ymir_theme';
  const THEMES={
    red:    {accent1:'#ff1d5a',accent2:'#ff5c90',spark1:'rgba(255,90,140,1)',spark2:'rgba(255,40,100,1)'},
    purple: {accent1:'#8b5cff',accent2:'#d19bff',spark1:'rgba(180,130,255,1)',spark2:'rgba(120,70,220,1)'},
    blue:   {accent1:'#00c2ff',accent2:'#66e0ff',spark1:'rgba(80,190,255,1)',  spark2:'rgba(30,120,255,1)'},
    green:  {accent1:'#19e07a',accent2:'#7af5bf',spark1:'rgba(90,255,180,1)',  spark2:'rgba(20,200,120,1)'}
  };
  function applyTheme(name){
    const t = THEMES[name] || THEMES.red;
    document.documentElement.style.setProperty('--accent1', t.accent1);
    document.documentElement.style.setProperty('--accent2', t.accent2);
    document.documentElement.style.setProperty('--spark1', t.spark1);
    document.documentElement.style.setProperty('--spark2', t.spark2);
    localStorage.setItem(THEME_KEY, name);
    // highlight button
    document.querySelectorAll('.chipBtn').forEach(b=>b.classList.toggle('active', b.dataset.theme===name));
  }
  document.querySelectorAll('.chipBtn').forEach(b => b.addEventListener('click', ()=>applyTheme(b.dataset.theme)));
  applyTheme(localStorage.getItem(THEME_KEY)||'red');

  /* ===== PRICING / PROMO ===== */
  const MIN1000=1000, MIN4000=4000, MIN8000=8000;
  const T1=0.80, T2=0.75, T3=0.70, PROMO_RATE=0.72;
  const PROMO_KEY='ymir_promo_until';

  function isPromoActive(){
    const u = parseInt(localStorage.getItem(PROMO_KEY)||'0');
    return u && Date.now() < u;
  }
  function promoUntil(){
    return parseInt(localStorage.getItem(PROMO_KEY)||'0') || 0;
  }
  function startPromo24h(){
    const until = Date.now() + 24*60*60*1000;
    localStorage.setItem(PROMO_KEY, String(until));
    paintPromo();
    compute();
  }
  function endPromo(){
    localStorage.removeItem(PROMO_KEY);
    paintPromo();
    compute();
  }
  function paintPromo(){
    const bar = $('promoBar');
    if (isPromoActive()){
      bar.style.display='block';
      tickPromoCountdown();
    } else {
      bar.style.display='none';
    }
  }
  function tickPromoCountdown(){
    if (!isPromoActive()) { $('promoBar').style.display='none'; return; }
    const left = promoUntil() - Date.now();
    const h = Math.max(0, Math.floor(left/3600000));
    const m = Math.max(0, Math.floor((left%3600000)/60000));
    const s = Math.max(0, Math.floor((left%60000)/1000));
    $('promoLeft').textContent = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
    if (left<=0) { endPromo(); return; }
    setTimeout(tickPromoCountdown, 1000);
  }
  $('startPromo').onclick = startPromo24h;
  $('endPromo').onclick = endPromo;
  paintPromo();

  function baseRate(q){
    if(!q || q<MIN1000) return null;
    if(q<MIN4000) return T1;
    if(q<MIN8000) return T2;
    return T3;
  }
  function rate(q){
    if (!q || q<MIN1000) return null;
    if (isPromoActive()) return PROMO_RATE; // promo overrides tiers
    return baseRate(q);
  }

  function estFromPhp(php){
    if (!php) return 0;
    // try around promo/base rates for accuracy
    let q = Math.floor(php/(isPromoActive()?PROMO_RATE:T1));
    for (let i=0;i<3;i++){ const r = rate(q) ?? (isPromoActive()?PROMO_RATE:T1); q = Math.floor(php/r); }
    return q;
  }

  // highlight + lock pills
  function paintPills(q, r){
    const p80=$('pill80'), p75=$('pill75'), p70=$('pill70');
    [p80,p75,p70].forEach(p=>{p.classList.remove('active','lock')});
    if(q<MIN1000){ p80.classList.add('lock'); p75.classList.add('lock'); p70.classList.add('lock'); return; }
    // in promo, show all unlocked and highlight all (or just label)
    if (isPromoActive()){
      // unlock all, visually hint promo on Rate box instead
      return;
    }
    if(q<MIN4000) p75.classList.add('lock');
    if(q<MIN8000) p70.classList.add('lock');
    if(r===T1) p80.classList.add('active');
    else if(r===T2) p75.classList.add('active');
    else if(r===T3) p70.classList.add('active');
  }

  /* ===== Inputs / compute ===== */
  let lastInput=null, lastRate=null;
  $('dias').addEventListener('input', ()=>{ lastInput='d'; compute(true); });
  $('phpIn').addEventListener('input', ()=>{ lastInput='p'; compute(true); });

  function compute(sync=true){
    let q = int($('dias').value);
    let p = num($('phpIn').value);

    if(lastInput==='p'){
      q = estFromPhp(p);
      if(sync) $('dias').value = q ? String(q) : '';
    }else if(lastInput==='d'){
      const rNow = rate(q);
      const total = rNow ? q*rNow : 0;
      if(sync) $('phpIn').value = total ? F(total) : '';
    }else{
      if(!q && p){ q = estFromPhp(p); $('dias').value = q?String(q):''; }
    }

    const r = rate(q);
    paintPills(q, r);

    const ok = q>=MIN1000;
    $('warn').style.display = ok ? 'none' : 'block';
    $('buyBtn').disabled = !ok;

    // outputs
    let rateTxt='‚Äî', saveTxt='‚Äî';
    if(q && r){
      rateTxt = isPromoActive() ? `PROMO ‚Ç±${r.toFixed(2)} / dia` : `‚Ç±${r.toFixed(2)} / dia`;
      const base = q*T1;
      const saveAmt = Math.max(0, base - (q*r));
      const savePct = Math.max(0,(1 - r/T1)*100);
      saveTxt = `${savePct.toFixed(2)}% ‚Ä¢ ‚Ç±${F(saveAmt)}`;
    }
    $('rateOut').textContent = rateTxt;
    $('saveOut').textContent = saveTxt;

    if(r !== lastRate && r && !isPromoActive()){
      const target = r===T1 ? $('pill80') : r===T2 ? $('pill75') : $('pill70');
      target.classList.remove('active'); void target.offsetWidth; target.classList.add('active');
      lastRate = r;
    }
  }
  compute();

  /* ===== Buy: copy + open Messenger ===== */
  function openMessenger(){
    if (MESSENGER_URL){
      window.open(MESSENGER_URL, '_blank');
    } else {
      // try to open messenger app; fallback: FB site
      const app = 'fb-messenger://';
      const fbweb = 'https://www.facebook.com/messages/';
      // attempt app
      const a = document.createElement('a');
      a.href = app; document.body.appendChild(a); a.click(); a.remove();
      setTimeout(()=>window.open(fbweb,'_blank'), 300); // fallback
    }
  }

  $('buyBtn').addEventListener('click', async ()=>{
    let q = int($('dias').value);
    let p = num($('phpIn').value);
    if (!q && p) q = estFromPhp(p);
    const r = rate(q);
    if (!r){ alert('Minimum 1000 üíé required.'); return; }
    const total = p || (q*r);

    const msg =
`BUY ORDER
Diamonds: ${q} üíé
Rate: ‚Ç±${r.toFixed(2)} / dia${isPromoActive()?' (PROMO)':''}
Total: ‚Ç±${F(total)}
GCash: 09162466318 (MOISES B.)`;

    try{ await navigator.clipboard.writeText(msg); }catch{}
    openMessenger();
    $('buyPopup').style.display='grid';
  });
  $('closePop').onclick = ()=> $('buyPopup').style.display='none';

  /* ===== GCash QR modal ===== */
  $('qrBtn').onclick = ()=> { $('qrModal').