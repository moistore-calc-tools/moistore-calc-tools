<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Legend of Ymir â€” Diamond Pricing</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0b0a0b;
    --red:#ff2b56;
    --text:#fff6f8;
    --muted:#d9c7cc;
    --green:#23cf6b;
    --blue:#1877f2;
    --discord:#5865f2;
    --glow1:0 0 16px rgba(255,30,80,.65), 0 0 32px rgba(255,30,80,.25);
    --ring: conic-gradient(from 0deg, #ff2b56, #ff5f93, #ff2b56);
  }
  *{box-sizing:border-box}
  html,body{
    margin:0;
    background:radial-gradient(1200px 600px at 50% -200px, #3a0013 0%, #14000a 40%, #0a0609 70%, #060407 100%);
    color:var(--text);
    font-family:Poppins,system-ui,Segoe UI,Roboto,Arial,sans-serif;
  }
  .wrap{max-width:760px;margin-inline:auto;padding:16px 14px 60px}

  /* Logo */
  ./* LOGO AREA â€” UPGRADED */
.logoWrap{
  display:grid;
  place-items:center;
  margin:14px 0 20px;
}

.logo{
  width:min(55vw,240px);
  aspect-ratio:1/1;
  border-radius:999px;
  position:relative;
  display:flex;
  justify-content:center;
  align-items:center;
  background:radial-gradient(circle at center, #100007 0%, #000 80%);
  box-shadow:
    0 0 40px rgba(255,0,80,.50),
    0 0 90px rgba(255,0,80,.45),
    0 0 140px rgba(255,0,80,.30);
}

.ring{
  position:absolute;
  inset:0;
  border-radius:50%;
  background:conic-gradient(
     from 0deg,
     #ff0044,
     #ff3377,
     #ff1166,
     #ff0044
  );
  filter:blur(3px);
  animation:spin 6s linear infinite;
  -webkit-mask:radial-gradient(circle, transparent 62%, #000 64%);
          mask:radial-gradient(circle, transparent 62%, #000 64%);
}

@keyframes spin{
  to { transform: rotate(360deg); }
}

.logo img{
  width:68%;
  border-radius:999px;
  box-shadow:
    0 0 25px rgba(255,100,150,.45),
    0 0 55px rgba(255,0,70,.35);
}
  /* Price tiles */
  .row{display:grid;gap:12px}
  .prices{grid-template-columns:repeat(3,1fr);margin:10px 0 12px}
  .card{
    background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.0));
    border-radius:18px;padding:14px 14px 12px;border:1px solid rgba(255,80,120,.16);
    box-shadow:inset 0 0 0 1px rgba(255,20,70,.06), var(--glow1);
  }
  .card h4{margin:0 0 6px;color:var(--muted);font-weight:600;font-size:14px;text-align:center}
  .price{font-size:28px;font-weight:800;letter-spacing:.3px;text-align:center}

  /* Inputs */
  .inputCard{
    background:linear-gradient(180deg,#170e14,#120c11);
    border-radius:18px;border:1px solid rgba(255,70,120,.18);
    padding:14px;box-shadow:var(--glow1);margin:6px 0
  }
  .label{font-size:13px;color:var(--muted);margin:4px 2px 6px}
  .in{
    width:100%;border:1px solid rgba(255,70,120,.18);background:#0b090c;
    color:var(--text);padding:14px 14px;border-radius:14px;font-size:18px;outline:none;
    box-shadow:0 0 0 0 rgba(255,40,90,.35), inset 0 0 18px rgba(255,10,60,.06);
    transition:border .15s, box-shadow .2s;
  }
  .in:focus{border-color:#ff5f93;box-shadow:0 0 0 3px rgba(255,60,110,.18), var(--glow1)}

  /* Applied + Save */
  .appliedRow{display:grid;grid-template-columns:1.1fr .9fr;gap:10px;margin:10px 0}
  .applied{
    background:linear-gradient(180deg,#1b1217,#130e13);border-radius:16px;border:1px solid rgba(255,70,120,.18);
    padding:12px 14px;box-shadow:var(--glow1);
  }
  .applied .big{font-size:22px;font-weight:800}
  .applied .small{font-size:12px;color:var(--muted)}
  .save{background:linear-gradient(180deg,#0f2a19,#0a1e12);border:1px solid rgba(40,255,160,.25)}

  /* Buttons */
  .btnRow{display:grid;grid-template-columns:1fr;gap:10px;margin:10px 0}
  .btn{
    display:inline-flex;align-items:center;justify-content:center;gap:10px;
    border:none;border-radius:14px;padding:14px 16px;font-weight:800;
    color:#05140b;background:var(--green);box-shadow:0 10px 30px rgba(35,207,107,.25);
    font-size:18px;letter-spacing:.3px;cursor:pointer
  }
  .btn:active{transform:translateY(1px)}
  .btn:disabled{opacity:.55;cursor:not-allowed}
  .completed{background:#1f8f53;color:#ecfff5}

  /* Payment + social */
  .payCard{background:linear-gradient(180deg,#121019,#0c0a10);border:1px solid rgba(60,90,255,.12);border-radius:18px;padding:12px 14px;margin:12px 0}
  .gcash{display:flex;align-items:center;gap:12px;background:radial-gradient(300px 100px at 0 0, rgba(24,119,242,.18), transparent), #0b0f1a;border:1px solid rgba(24,119,242,.28);color:#eaf3ff;padding:12px 14px;border-radius:14px;font-weight:700}
  .socRow{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
  .sbtn{display:flex;align-items:center;gap:10px;justify-content:center;padding:14px;border-radius:14px;font-weight:800;border:none;cursor:pointer}
  .fb{background:var(--blue);color:#fff}
  .dc{background:var(--discord);color:#fff}

  /* Completed row above transactions */
  .completeRow{display:flex;justify-content:flex-end;margin-top:8px}

  /* Transactions pill */
  .txBox{display:flex;align-items:center;justify-content:center;gap:10px;background:linear-gradient(180deg,#121512,#0c0f0c);border:1px solid rgba(80,255,120,.22);border-radius:18px;padding:14px;margin-top:10px;box-shadow:0 0 22px rgba(20,255,120,.12)}
  .txNum{font-size:24px;font-weight:900;letter-spacing:.5px}

  .muter{font-size:12px;color:var(--muted);margin-top:6px}

  @media (max-width:540px){
    .prices{grid-template-columns:repeat(3,1fr)}
    .appliedRow{grid-template-columns:1fr}
    .socRow{grid-template-columns:1fr 1fr}
  }
</style>
</head>
<body>
  <div class="wrap">
    <!-- Neon logo -->
    <div class="logoWrap">
      <div class="logo">
        <div class="ring"></div>
        <img src="logo.png" alt="Moistore" />
      </div>
    </div>

    <!-- Prices -->
    <div class="row prices">
      <div class="card"><h4>Price / dia</h4><div class="price">â‚±0.80</div></div>
      <div class="card"><h4>Price / dia</h4><div class="price">â‚±0.75</div></div>
      <div class="card"><h4>Price / dia</h4><div class="price">â‚±0.70</div></div>
    </div>

    <!-- Inputs -->
    <div class="inputCard">
      <div class="label">Enter Diamonds ðŸ’Ž</div>
      <input id="dias" class="in" inputmode="numeric" placeholder="e.g. 1500">

      <div class="label" style="margin-top:10px">ENTER PHP â‚±</div>
      <input id="phpIn" class="in" inputmode="decimal" placeholder="e.g. 500.00">
    </div>

    <!-- Applied + Save -->
    <div class="appliedRow">
      <div class="applied">
        <div class="small">Applied Tier Rate</div>
        <div class="big" id="tierBig">â€”</div>
      </div>
      <div class="applied save">
        <div class="small">Save vs â‚±0.80 base</div>
        <div class="big" id="saveBig">â€”</div>
      </div>
    </div>

    <!-- BUY -->
    <div class="btnRow">
      <button id="buyBtn" class="btn">ðŸ’Ž Buy</button>
    </div>
    <div class="muter">Enter at least 500 dias or PHP equivalent.</div>

    <!-- Payment + Social -->
    <div class="payCard">
      <div class="gcash">GCash â€¢ <strong>09162466318 â€” MOISES B.</strong></div>
      <div class="socRow">
        <button class="sbtn fb" id="fbBtn">ðŸ“˜ Facebook Page</button>
        <button class="sbtn dc" id="dcBtn">ðŸŸ£ Discord Server</button>
      </div>
    </div>

    <!-- Completed button ABOVE transactions -->
    <div class="completeRow">
      <button id="confirmBtn" class="btn completed">âœ… Completed</button>
    </div>

    <!-- Transactions -->
    <div class="txBox">
      <span style="opacity:.85">Transactions</span>
      <span class="txNum" id="txNum">0</span>
    </div>
  </div>

  <!-- BUY POPUP -->
  <div id="buyPopup" style="
    position:fixed; inset:0; display:none; place-items:center;
    background:rgba(0,0,0,.55); backdrop-filter:blur(4px); z-index:9999;">
    <div style="
      background:#160c13; border:1px solid rgba(255,70,120,.35);
      border-radius:18px; padding:22px 20px; width:80%; max-width:300px;
      text-align:center; box-shadow:0 0 25px rgba(255,0,80,.45);">
      <div style="font-size:17px; font-weight:700; margin-bottom:8px;">
        âœ… COPIED!
      </div>
      <div style="font-size:14px; opacity:.85; margin-bottom:18px;">
        <b>I-paste mo ito sa Messenger ko</b> para ma-process ang order.
      </div>
      <button id="closePopup" style="
        background:#ff2b56; color:#fff; border:none; padding:10px 14px;
        border-radius:12px; font-weight:700; cursor:pointer; width:100%;">
        OKAY âœ…
      </button>
    </div>
  </div>

  <script>
    const $ = id => document.getElementById(id);

    const MIN_DIAS = 500;
    const T1 = 0.80, T2 = 0.75, T3 = 0.70;

    function rateByQty(q){
      if (!q || q < MIN_DIAS) return null;
      if (q <= 3000) return T1;
      if (q <= 7000) return T2;
      return T3;
    }

    // Diamonds from PHP (iterate to lock correct tier)
    function estimateDiamondsFromPhp(php){
      if (!php || php <= 0) return 0;
      let q = Math.floor(php / T1);
      for (let i=0;i<3;i++){
        const r = rateByQty(q) ?? T1;
        q = Math.floor(php / r);
      }
      return q;
    }

    function fmtMoney(n){
      if (n===null || isNaN(n)) return "";
      return Number(n).toLocaleString(undefined,{minimumFractionDigits:2, maximumFractionDigits:2});
    }
    function fmtRate(r){ return r ? `â‚±${r.toFixed(2)} / dia` : "â€”"; }

    const diasEl = $('dias'), phpEl = $('phpIn'), tierBig = $('tierBig'), saveBig = $('saveBig');
    let lastEdited = null; // 'dias' | 'php'

    diasEl.addEventListener('input', ()=>{ lastEdited='dias'; compute(true); });
    phpEl.addEventListener('input',  ()=>{ lastEdited='php';  compute(true); });

    function compute(syncFields=false){
      let q = parseInt(String(diasEl.value).replace(/[^0-9]/g,'')) || 0;
      let php = parseFloat(String(phpEl.value).replace(/[^0-9.]/g,'')) || 0;

      if (lastEdited==='php'){
        q = estimateDiamondsFromPhp(php);
        if (syncFields) diasEl.value = q ? String(q) : "";
      } else if (lastEdited==='dias'){
        const r = rateByQty(q);
        const total = (r ? q * r : 0);
        if (syncFields) phpEl.value = total ? fmtMoney(total) : "";
      }

      const rate = rateByQty(q);
      let total = rate ? q*rate : 0;

      let saveAmt = null, savePct = null;
      if (q && rate){
        const base = q * T1;
        saveAmt = Math.max(0, base - total);
        savePct = Math.max(0, (1 - rate/T1) * 100);
      }

      tierBig.textContent = fmtRate(rate);
      saveBig.textContent = (saveAmt===null) ? "â€”" : `${savePct.toFixed(2)}% â€¢ â‚±${fmtMoney(saveAmt)}`;
    }
    compute();

    // BUY â€” copy message + popup
    $('buyBtn').addEventListener('click', async ()=>{
      let q = parseInt(String(diasEl.value).replace(/[^0-9]/g,'')) || 0;
      let php = parseFloat(String(phpEl.value).replace(/[^0-9.]/g,'')) || 0;
      if (!q && php) q = estimateDiamondsFromPhp(php);
      const r = rateByQty(q);
      if (!r){ alert('Enter at least 500 dias or PHP equivalent.'); return; }
      const total = (php && php>0) ? php : (q*r);
      const txt = `BUY ORDER\nâ€¢ Diamonds: ${q} ðŸ’Ž\nâ€¢ Tier: â‚±${r.toFixed(2)} / dia\nâ€¢ Total: â‚±${fmtMoney(total)}\nâ€¢ GCash: 09162466318 (MOISES B.)`;
      try{ await navigator.clipboard.writeText(txt); }catch{ alert(txt); }
      document.getElementById("buyPopup").style.display = "grid";
    });

    // Completed (1x per device) with chime + local counter
    const TX_KEY='ymir_device_completed';
    const COUNT_KEY='ymir_tx_count';
    function setTxUI(){
      const c = parseInt(localStorage.getItem(COUNT_KEY)||'0');
      $('txNum').textContent = isNaN(c)?'0':String(c);
      const done = localStorage.getItem(TX_KEY)==='1';
      const btn = $('confirmBtn');
      btn.disabled = done;
      btn.textContent = done ? 'âœ… Completed' : 'âœ… Completed';
      btn.style.opacity = done ? .7 : 1;
    }
    setTxUI();

    $('confirmBtn').addEventListener('click', ()=>{
      if (localStorage.getItem(TX_KEY)==='1') return;
      chime();
      localStorage.setItem(TX_KEY,'1');
      const c = parseInt(localStorage.getItem(COUNT_KEY)||'0') + 1;
      localStorage.setItem(COUNT_KEY,String(c));
      setTxUI();
    });

    // Soft chime
    function chime(){
      try{
        const a = new (window.AudioContext||window.webkitAudioContext)();
        const o = a.createOscillator(); const g = a.createGain();
        o.type='sine'; o.frequency.setValueAtTime(660,a.currentTime);
        g.gain.setValueAtTime(0.0001,a.currentTime);
        g.gain.exponentialRampToValueAtTime(0.2,a.currentTime+0.02);
        o.connect(g).connect(a.destination); o.start();
        o.frequency.exponentialRampToValueAtTime(990, a.currentTime+0.18);
        g.gain.exponentialRampToValueAtTime(0.0001, a.currentTime+0.25);
        o.stop(a.currentTime+0.26);
      }catch(e){}
    }

    // Social links
    $('fbBtn').addEventListener('click', ()=> window.open('https://www.facebook.com/share/p/1DB1da3qMn/','_blank'));
    $('dcBtn').addEventListener('click', ()=> window.open('https://discord.gg/QkdVz5mh','_blank'));

    // Popup close
    document.getElementById("closePopup").onclick = () =>{
      document.getElementById("buyPopup").style.display = "none";
    };
  </script>
</body>
</html>