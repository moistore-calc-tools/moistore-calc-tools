<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>YMIR â€” Stock Only</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{--ink:#09060a;--txt:#fff7fb;--mut:#ccb9c1;--ring:conic-gradient(#ff2b63,#ff6ea0,#ff2b63);--border:rgba(255,100,140,.18)}
  *{box-sizing:border-box}
  html,body{margin:0;background:var(--ink);color:var(--txt);font-family:Poppins,system-ui,Segoe UI,Roboto,Arial,sans-serif;min-height:100%}
  body::before{content:"";position:fixed;inset:-20% -20%;z-index:-1;pointer-events:none;background:
    radial-gradient(40% 30% at 15% 10%, rgba(255,40,100,.14), transparent 60%),
    radial-gradient(38% 28% at 85% 5%, rgba(200,20,80,.10), transparent 65%),
    radial-gradient(55% 40% at 50% 110%, rgba(255,30,100,.10), transparent 72%);
    filter: blur(10px) saturate(112%)}
  .wrap{max-width:760px;margin:auto;padding:24px 14px 120px}
  .title{display:flex;gap:10px;justify-content:center;align-items:center;font-weight:800;font-size:22px;letter-spacing:.4px;margin:8px 0 14px}
  .logoWrap{display:grid;place-items:center;margin:6px 0 16px}
  .logo{width:min(44vw,160px);aspect-ratio:1/1;border-radius:999px;position:relative;display:grid;place-items:center;background:radial-gradient(120px 110px at 50% 50%, #0e0a0d 40%, #000 100%);box-shadow:0 0 0 8px rgba(0,0,0,.55)}
  .ring{position:absolute;inset:10px;border-radius:999px;background:var(--ring);filter:blur(.55px);-webkit-mask:radial-gradient(circle, transparent 61.5%, #000 63%);mask:radial-gradient(circle, transparent 61.5%, #000 63%);animation:spin 9s linear infinite;opacity:.55}
  @keyframes spin{to{transform:rotate(360deg)}}
  .logo img{width:78%;border-radius:999px;box-shadow:0 0 18px rgba(255,40,100,.28)}

  .card{background:linear-gradient(180deg,#1a1014,#120a10);border:1px solid var(--border);border-radius:18px;box-shadow:0 0 16px rgba(0,0,0,.25)}
  .body{padding:16px}
  .center{text-align:center}

  .bigBtn{display:inline-flex;align-items:center;gap:10px;justify-content:center;padding:16px 18px;border-radius:14px;font-weight:900;border:1px solid rgba(255,255,255,.22);background:linear-gradient(180deg,#ffb45a,#ff9b3d);color:#2b1200;box-shadow:0 18px 44px rgba(255,160,80,.24), inset 0 -6px 0 rgba(0,0,0,.12);cursor:pointer}
  .miniBtn{padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.18);background:#141116;color:#fff;font-weight:700;cursor:pointer}

  /* Popups */
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;place-items:center;z-index:50}
  .pop{width:min(96vw,920px);background:#0f0d10;border:1px solid var(--border);border-radius:18px;padding:16px}
  .popHead{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:10px}
  .hint{font-size:12px;color:#ccb9c1}

  table{width:100%;border-collapse:collapse}
  th,td{border-bottom:1px dashed rgba(255,255,255,.12);padding:10px 8px;text-align:center}
  th{color:#ffb6cc;font-size:12px}
  td[contenteditable="true"]{outline:2px dashed transparent}
  td[contenteditable="true"]:focus{outline-color:#ff6aa1}
  .thumb{width:44px;height:44px;border-radius:8px;border:1px solid rgba(255,255,255,.14);object-fit:cover}
</style>
</head>
<body>
  <div class="wrap">
    <div class="title">LEGEND OF YMIR â€” STOCK</div>
    <div class="logoWrap">
      <div class="logo"><div class="ring"></div><img src="logo.png" alt="Logo"></div>
    </div>

    <div class="card">
      <div class="body center">
        <button id="openStock" class="bigBtn">ðŸ“¦ Open Stock</button>
        <div class="hint" style="margin-top:8px">Tap the button to manage your inventory (saved locally).</div>
      </div>
    </div>
  </div>

  <!-- STOCK POPUP (Inventory appears only when button is pressed) -->
  <div id="stockOverlay" class="overlay">
    <div class="pop">
      <div class="popHead">
        <div>
          <div style="font-weight:900">ðŸ“¦ Stock Inventory</div>
          <div class="hint">Editable â€¢ Saved in this device (localStorage)</div>
        </div>
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <button id="sAdd" class="miniBtn">+ Row</button>
          <button id="sSave" class="miniBtn">Save</button>
          <button id="sReset" class="miniBtn">Reset</button>
          <button id="sCSV" class="miniBtn">Export CSV</button>
          <button id="sMass" class="miniBtn">Mass Update</button>
          <button id="sClose" class="miniBtn">Close</button>
        </div>
      </div>

      <table class="stock">
        <thead>
          <tr><th>Pic</th><th>Server</th><th>Qty</th><th>Notes</th><th></th></tr>
        </thead>
        <tbody id="stockBody"></tbody>
      </table>

      <div class="hint" style="margin-top:8px">Tip: click the picture to add/change image. Use Mass Update for fast edits.</div>

      <!-- hidden inputs for image edit -->
      <input id="stFile" type="file" accept="image/*" style="display:none"/>
    </div>
  </div>

  <!-- MASS UPDATE POPUP -->
  <div id="massOverlay" class="overlay">
    <div class="pop" style="max-width:600px">
      <div class="popHead" style="margin-bottom:6px">
        <div style="font-weight:900">ðŸ§© Mass Update</div>
        <button id="massClose" class="miniBtn">Close</button>
      </div>
      <div class="hint">Paste CSV lines: <code>Server,Qty,Notes</code>. Existing rows will be updated, new ones added.</div>
      <textarea id="massText" class="in" style="width:100%;height:180px;margin-top:8px;background:#141116;border:1px solid rgba(255,255,255,.18);color:#fff;border-radius:12px;padding:10px"></textarea>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
        <button id="massApply" class="miniBtn">Apply</button>
      </div>
    </div>
  </div>

<script>
(function(){
  document.addEventListener('DOMContentLoaded',()=>{
    const $=id=>document.getElementById(id);

    // Local keys
    const STOCK_KEY='ymir_stock_v1';
    const IMG_KEY='ymir_stock_img_v1';

    const DEFAULT_STOCK=[["HOF1","/",""],["DaddyKin","3000",""],["Tokyo","15400",""],["HOF2","2040",""],["DaddyVerse","4912",""],["Kings","6440",""],["HOF3","1000",""],["ManiTW","9000",""],["ISEKAI","35000",""],["Bangkok","1286",""],["PROSGARD","900",""],["X","3900",""],["Chess","7444",""],["XAOU","14269",""],["ASIA015","3000",""],["ASIA016","9000",""],["ASIA017","3200",""],["ASIA018","4500",""],["ASIA020","3000",""],["ASIA021","1500",""],["ASIA023","2000",""],["ASIA024","1400",""],["ASIA025","3000",""],["ASIA027","1500",""],["ASIA028","9300",""]];

    const loadStock=()=>{try{const r=JSON.parse(localStorage.getItem(STOCK_KEY)||'null');if(Array.isArray(r)&&r.length)return r}catch{}return DEFAULT_STOCK.map(r=>[...r])};
    const saveStock=r=>{try{localStorage.setItem(STOCK_KEY,JSON.stringify(r))}catch{}};
    const loadImgs=()=>{try{return JSON.parse(localStorage.getItem(IMG_KEY)||'{}')}catch{return{}}};
    const saveImgs=m=>{try{localStorage.setItem(IMG_KEY,JSON.stringify(m))}catch{}};

    let STOCK=loadStock();
    let IMGS=loadImgs();

    const sBody=$('stockBody');

    function renderStock(){
      sBody.innerHTML='';
      STOCK.forEach((row,i)=>{
        const tr=document.createElement('tr');
        const key=row[0]||('row'+i);
        const tdImg=document.createElement('td');
        const img=document.createElement('img');
        img.className='thumb';
        img.src=IMGS[key]||'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2244%22 height=%2244%22><rect width=%2244%22 height=%2244%22 fill=%22%23131116%22/><text x=%2250%25%22 y=%2255%25%22 fill=%22%23ff6aa1%22 font-size=%2210%22 text-anchor=%22middle%22>IMG</text></svg>';
        img.title='Click to change';
        img.onclick=()=>{ $('stFile').onchange=(e)=>{ const f=e.target.files&&e.target.files[0]; if(!f) return; const reader=new FileReader(); reader.onload=()=>{ IMGS[key]=reader.result; saveImgs(IMGS); renderStock(); }; reader.readAsDataURL(f); }; $('stFile').click(); };
        tdImg.appendChild(img);

        const tdS=document.createElement('td'); tdS.contentEditable=true; tdS.textContent=row[0];
        const tdQ=document.createElement('td'); tdQ.contentEditable=true; tdQ.textContent=row[1];
        const tdN=document.createElement('td'); tdN.contentEditable=true; tdN.textContent=row[2]||'';
        const tdA=document.createElement('td'); const del=document.createElement('button'); del.className='miniBtn'; del.textContent='Delete'; del.onclick=()=>{ STOCK.splice(i,1); saveStock(STOCK); renderStock(); }; tdA.appendChild(del);

        [tdS,tdQ,tdN].forEach((td,idx)=> td.addEventListener('input',()=>{ row[idx]=td.textContent.trim(); saveStock(STOCK); }));

        tr.append(tdImg,tdS,tdQ,tdN,tdA); sBody.appendChild(tr);
      });
    }

    // Button actions
    $('openStock').onclick=()=>{ $('stockOverlay').style.display='grid'; renderStock(); };
    $('sClose').onclick=()=>{ $('stockOverlay').style.display='none'; };

    $('sAdd').onclick=()=>{ STOCK.push(['','/','']); saveStock(STOCK); renderStock(); };
    $('sSave').onclick=()=>{ saveStock(STOCK); flash('Stock saved'); };
    $('sReset').onclick=()=>{ if(confirm('Reset stock to defaults?')){ STOCK=DEFAULT_STOCK.map(r=>[...r]); saveStock(STOCK); renderStock(); } };
    $('sCSV').onclick=()=>{ const rows=[["server","qty","notes"], ...STOCK]; const csv=rows.map(r=>r.map(x=>`"${String(x).replaceAll('"','""')}"`).join(',')).join('\n'); downloadText('ymir_stock.csv', csv); };

    // Mass update overlay
    $('sMass').onclick=()=>{ $('massOverlay').style.display='grid'; };
    $('massClose').onclick=()=>{ $('massOverlay').style.display='none'; };
    $('massApply').onclick=()=>{ const txt=$('massText').value.trim(); if(!txt){ $('massOverlay').style.display='none'; return; }
      txt.split(/\r?\n/).forEach(line=>{ const parts=line.split(','); if(!parts[0]) return; const name=parts[0].trim(); const qty=(parts[1]||'').trim(); const notes=(parts[2]||'').trim(); const idx=STOCK.findIndex(r=>r[0].toLowerCase()===name.toLowerCase()); if(idx>-1){ STOCK[idx]=[name,qty,notes]; } else { STOCK.push([name,qty,notes]); } });
      saveStock(STOCK); renderStock(); flash('Mass update applied'); $('massOverlay').style.display='none'; };

    function downloadText(filename,text){ const a=document.createElement('a'); a.href=URL.createObjectURL(new Blob([text],{type:'text/plain'})); a.download=filename; a.click(); URL.revokeObjectURL(a.href); }
    function flash(text){ const el=document.createElement('div'); el.textContent=text; el.style.cssText='position:fixed;inset:auto auto 20px 50%;transform:translateX(-50%);background:#ffb45a;color:#2b1200;padding:10px 14px;border-radius:999px;font-weight:800;box-shadow:0 10px 20px rgba(0,0,0,.45);z-index:9999'; document.body.appendChild(el); setTimeout(()=>el.remove(),1400); }
  });
})();
</script>
</body>
</html>
