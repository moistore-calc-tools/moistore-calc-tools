<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>LEGEND OF YMIR DIAMOND üíé</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --txt:#fff7fb; --mut:#ccb9c1; --mut2:#a8989f;
    --green:#21d072; --blue:#1877f2; --discord:#5865f2;
    --red1:#1a0f14; --red2:#120a10; --ink:#09060a;
    --border: rgba(255,100,140,.18);
    --ring: conic-gradient(#ff2b63,#ff6ea0,#ff2b63);
    --glow-soft: 0 0 16px rgba(255,40,100,.22);
    --chip:#222027;
  }
  *{box-sizing:border-box}
  html,body{margin:0;color:var(--txt);font-family:Poppins,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:var(--ink);min-height:100%}

  /* Animated dark red background */
  body::before{
    content:"";position:fixed;inset:-20% -20%;z-index:-3;pointer-events:none;
    background:
      radial-gradient(40% 30% at 15% 10%, rgba(255,40,100,.14), transparent 60%),
      radial-gradient(38% 28% at 85% 5%, rgba(200,20,80,.10), transparent 65%),
      radial-gradient(55% 40% at 50% 110%, rgba(255,30,100,.10), transparent 72%);
    filter: blur(10px) saturate(112%);
    animation:bgFloat 16s ease-in-out infinite alternate;
  }
  @keyframes bgFloat{0%{transform:translate3d(0,0,0)}100%{transform:translate3d(1.2%,-1.2%,0)}}
  body::after{
    content:"";position:fixed;inset:0;z-index:-2;pointer-events:none;opacity:.45;
    background:
      radial-gradient(circle at 18% 28%, rgba(255,80,130,.25) 0 1px, transparent 2px),
      radial-gradient(circle at 78% 18%, rgba(255,60,110,.22) 0 1px, transparent 2px),
      radial-gradient(circle at 68% 78%, rgba(255,50,100,.20) 0 1px, transparent 2px),
      radial-gradient(circle at 28% 82%, rgba(255,70,120,.18) 0 1px, transparent 2px);
    animation:spark 11s linear infinite;
  }
  @keyframes spark{0%{transform:translateY(0)}100%{transform:translateY(-8px)}}

  .wrap{max-width:760px;margin:auto;padding:16px 14px 120px}
  .title{display:flex;gap:10px;justify-content:center;font-weight:800;font-size:22px;letter-spacing:.4px;margin:2px 0 8px;text-shadow:0 0 10px rgba(255,70,120,.25)}

  /* Logo */
  .logoWrap{display:grid;place-items:center;margin:6px 0 8px}
  .logo{width:min(44vw,186px);aspect-ratio:1/1;border-radius:999px;position:relative;display:grid;place-items:center;background:radial-gradient(120px 110px at 50% 50%, #0e0a0d 40%, #000 100%);box-shadow:0 0 0 8px rgba(0,0,0,.55); cursor:pointer}
  .ring{position:absolute;inset:10px;border-radius:999px;background:var(--ring);filter:blur(.55px);-webkit-mask:radial-gradient(circle, transparent 61.5%, #000 63%);mask:radial-gradient(circle, transparent 61.5%, #000 63%);animation:spin 9s linear infinite;opacity:.55}
  @keyframes spin{to{transform:rotate(360deg)}}
  .logo img{width:82%;border-radius:999px;box-shadow:0 0 18px rgba(255,40,100,.28)}

  /* Owner (under logo) */
  .owner{margin:10px auto 8px;display:flex;gap:10px;align-items:center;justify-content:center;padding:10px 12px;border-radius:14px;background:linear-gradient(180deg,#131218,#0d0c12);border:1px solid rgba(255,255,255,.10);box-shadow:0 0 16px rgba(0,0,0,.25);font-weight:800;max-width:560px}
  .owner a{color:#fff;text-decoration:none;display:inline-flex;align-items:center;gap:8px}
  .ownerName{letter-spacing:.3px}
  .metaBadge{width:22px;height:22px;display:inline-block;filter: drop-shadow(0 0 10px rgba(24,119,242,.45))}

  /* Tiers */
  .row{display:grid;gap:12px}
  .prices{display:grid;grid-template-columns:repeat(3,1fr);margin:6px 0 10px}
  .pill{position:relative;background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.00));border:1px solid var(--border);border-radius:18px;padding:12px;text-align:center;box-shadow:inset 0 0 0 1px rgba(255,30,80,.06), var(--glow-soft);transition:transform .18s, box-shadow .18s, border-color .18s, opacity .18s}
  .pval{font-size:26px;font-weight:900}
  .ptxt{font-size:12px;color:#ccb9c1}
  .pill.active{transform:translateY(-2px) scale(1.02);border-color:rgba(80,255,170,.55);box-shadow:0 0 20px rgba(40,255,170,.26), inset 0 0 0 1px rgba(40,255,170,.28)}
  .pill.lock{opacity:.55;filter:grayscale(.25);border-color:rgba(255,255,255,.10);box-shadow:none}

  /* üî• Flaming effect for ‚Ç±0.70 when active */
  .pill.flame {
    border-color: rgba(255,120,0,.7) !important;
    box-shadow:
      0 0 24px rgba(255,120,0,.35),
      0 0 42px rgba(255,60,0,.25),
      inset 0 0 0 1px rgba(255,150,80,.35);
    animation: flamePulse 1.2s ease-in-out infinite;
  }
  .pill.flame::before,
  .pill.flame::after{
    content:"";
    position:absolute; left:50%; transform:translateX(-50%);
    width:64%; height:46%;
    bottom:-8px; border-radius:50% 50% 40% 40%;
    filter: blur(8px) drop-shadow(0 0 12px rgba(255,120,0,.55));
    pointer-events:none;
  }
  .pill.flame::before{
    background: radial-gradient(60% 70% at 50% 80%,
      rgba(255,180,60,.9) 0%,
      rgba(255,110,30,.75) 35%,
      rgba(255,60,0,.55) 60%,
      rgba(255,60,0,0) 72%);
    animation: flameFlicker 180ms infinite steps(2,end);
  }
  .pill.flame::after{
    background: radial-gradient(55% 65% at 50% 78%,
      rgba(255,240,200,.85) 0%,
      rgba(255,170,80,.65) 35%,
      rgba(255,90,0,.45) 60%,
      rgba(255,90,0,0) 72%);
    opacity:.9; mix-blend-mode: screen;
    animation: flameRise 1.6s ease-in-out infinite;
  }
  @keyframes flamePulse { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-1px); } }
  @keyframes flameFlicker { 50% { filter: blur(10px) drop-shadow(0 0 16px rgba(255,140,0,.65)); } }
  @keyframes flameRise {
    0%{ transform: translateX(-50%) translateY(0) scale(1); opacity:.85; }
    50%{ transform: translateX(-50%) translateY(-2px) scale(1.04); opacity:.95; }
    100%{ transform: translateX(-50%) translateY(0) scale(1); opacity:.85; }
  }

  /* üîñ BEST DEAL chip (shows only when 0.70 active) */
  .dealChip{
    position:absolute; top:-10px; right:-10px;
    background:linear-gradient(180deg,#ffb66a,#ff7b2c);
    color:#2b1200; font-weight:900; font-size:11px;
    padding:6px 8px; border-radius:999px; box-shadow:0 8px 22px rgba(255,120,0,.35);
    border:1px solid rgba(255,255,255,.35);
    display:flex; align-items:center; gap:6px;
    transform:scale(.9); opacity:0; pointer-events:none;
    transition:opacity .18s ease, transform .18s ease;
  }
  .pill.best .dealChip{ opacity:1; transform:scale(1); }

  /* Card / Inputs */
  .section{background:linear-gradient(180deg,var(--red1),var(--red2));border:1px solid var(--border);border-radius:18px;padding:14px;box-shadow:var(--glow-soft)}
  .label{font-size:13px;color:#ccb9c1;margin:4px 2px 6px}
  .in{width:100%;border:1px solid rgba(255,120,160,.20);background:#0b090c;color:#fff;padding:14px;border-radius:14px;font-size:18px;outline:none;box-shadow:inset 0 0 14px rgba(255,20,80,.06), 0 0 12px rgba(255,40,100,.12)}
  .in:focus{border-color:#ff6aa1;box-shadow:0 0 0 3px rgba(255,60,110,.16), var(--glow-soft)}
  .hint{font-size:12px;color:#a8989f;margin-top:6px}
  .warn{margin-top:8px;font-size:12px;color:#ff7b94;display:none}
  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:10px}
  .box{background:linear-gradient(180deg,#1a1218,#120e13);border:1px solid rgba(255,120,160,.18);border-radius:16px;padding:12px;text-align:center;box-shadow:var(--glow-soft)}
  .box h5{margin:0 0 4px;font-size:12px;color:#ccb9c1}
  .rateOut{font-weight:900;font-size:20px}
  .saveOut{font-weight:900;font-size:20px;color:#baffd6}
  .saveBox{background:linear-gradient(180deg,#0f2117,#0a1a11);border-color:rgba(40,255,160,.24)}

  /* Buttons */
  .btn{display:inline-flex;align-items:center;justify-content:center;gap:10px;border:none;border-radius:14px;padding:14px 16px;font-weight:800;letter-spacing:.2px;cursor:pointer;user-select:none}
  .buy{background:var(--green);color:#092112;font-size:18px;box-shadow:0 18px 44px rgba(33,208,114,.24), inset 0 -6px 0 rgba(0,0,0,.12);width:100%;margin-top:10px;transition:transform .12s}
  .buy:active{transform:translateY(1px)}
  .btn[disabled]{opacity:.55;filter:grayscale(.25);cursor:not-allowed}

  /* Payment + socials */
  .pay{background:linear-gradient(180deg,#11111a,#0b0c12);border:1px solid rgba(24,119,242,.18);border-radius:18px;padding:12px 14px;box-shadow:0 0 18px rgba(24,119,242,.12);margin-top:10px}
  .gcashRow{
    display:flex;align-items:center;gap:12px;justify-content:space-between;
    background:rgba(24,119,242,.08);border:1px solid rgba(24,119,242,.28);
    padding:10px 12px;border-radius:12px;max-width:560px;margin:8px auto 10px;
    box-shadow: 0 10px 24px rgba(24,119,242,.10); font-weight:800; cursor:pointer
  }
  .gcashLeft{display:flex;align-items:center;gap:10px}
  .gcashIcon{
    width:26px;height:26px;border-radius:999px;background:#1877f2;display:grid;place-items:center;
    box-shadow:0 0 10px rgba(24,119,242,.35), inset 0 0 8px rgba(255,255,255,.14);
    font-weight:900;color:#fff;letter-spacing:.2px;user-select:none;
  }
  .qrBtn{display:inline-flex;align-items:center;gap:8px;background:rgba(24,119,242,.14);color:#eaf3ff;border:1px solid rgba(24,119,242,.38);padding:8px 12px;border-radius:10px;font-weight:800}
  .qrBtn svg{filter:drop-shadow(0 0 6px rgba(24,119,242,.42))}
  .soc{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
  .btnlink{display:inline-flex;align-items:center;justify-content:center;gap:10px;border-radius:14px;padding:14px 16px;font-weight:800;letter-spacing:.2px;text-decoration:none}
  .fb{background:var(--blue);color:#fff}
  .dc{background:var(--discord);color:#fff}

  /* Notice */
  .notice{margin-top:12px;padding:12px 14px;border-radius:14px;background:linear-gradient(180deg,#17141a,#120f14);border:1px solid rgba(255,255,255,.12);box-shadow:0 0 16px rgba(0,0,0,.25)}
  .notice h4{margin:0 0 6px;font-size:14px}
  .notice p{margin:0;color:#ccb9c1;font-size:13px}

  /* Track Order */
  .track{margin-top:14px;background:linear-gradient(180deg,#151218,#100f13);border:1px solid rgba(255,255,255,.10);border-radius:14px;padding:14px;box-shadow:0 0 16px rgba(0,0,0,.25)}
  .chip{display:inline-flex;gap:8px;align-items:center;background:var(--chip);border:1px solid rgba(255,255,255,.08);padding:8px 12px;border-radius:12px}

  /* Stock UI */
  .stockChip{display:inline-flex;align-items:center;gap:10px;background:#1a1418;border:1px solid rgba(255,255,255,.1);padding:8px 12px;border-radius:12px;box-shadow:0 0 16px rgba(0,0,0,.25);cursor:pointer}
  .badge{font-size:11px;color:#ccb9c1;border:1px solid rgba(255,255,255,.14);padding:2px 6px;border-radius:999px;display:none} /* hidden hint text */
  #stockModal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;place-items:center;z-index:60}
  .stockCard{width:min(95vw,720px);background:#100d11;border:1px solid var(--border);border-radius:16px;box-shadow:0 18px 60px rgba(0,0,0,.55)}
  .stockHead{display:flex;gap:10px;align-items:center;padding:12px 14px;border-bottom:1px solid rgba(255,255,255,.08)}
  .stockHead h3{margin:0;font-size:16px}
  .stockTools{display:flex;gap:10px;align-items:center;margin-left:auto}
  .stockSearch{display:flex;align-items:center;gap:6px;background:#17141a;border:1px solid rgba(255,255,255,.12);padding:6px 8px;border-radius:999px}
  .stockSearch input{background:transparent;border:none;outline:none;color:#fff}
  .stockBody{max-height:65vh;overflow:auto;padding:8px 10px}
  .srvRow{display:grid;grid-template-columns:1fr auto auto;gap:10px;align-items:center;border-bottom:1px dashed rgba(255,255,255,.08);padding:8px}
  .srvRow h4{margin:0;font-size:14px}
  .srvCnt{font-weight:900}
  .srvCnt.edit input{width:110px;background:#0d0b0e;color:#fff;border:1px solid rgba(255,255,255,.18);border-radius:8px;padding:6px 8px}
  .btnTiny{border:none;border-radius:10px;padding:8px 10px;font-weight:800;cursor:pointer}
  .btnGhost{background:#231f27;color:#fff;border:1px solid rgba(255,255,255,.1)}
  .btnPri{background:#21d072;color:#071b11}
  .stockFoot{display:flex;gap:10px;justify-content:flex-end;padding:10px 12px;border-top:1px solid rgba(255,255,255,.08)}
  .nameEdit{width:180px;background:#0d0b0e;color:#fff;border:1px solid rgba(255,255,255,.18);border-radius:8px;padding:6px 8px}

  /* Popups */
  #buyPopup, #gcashPopup, #qrPopup, #goPopup, #goQRPopup, #stockModal{user-select:none}
  #buyPopup, #gcashPopup, #qrPopup{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;place-items:center;z-index:50}
  .cardPop{width:min(92vw,520px);background:#0f0d10;border:1px solid var(--border);border-radius:18px;padding:18px;text-align:center}
  .qrImg{max-width:86vw;max-height:70vh;border-radius:12px;border:1px solid rgba(255,255,255,.15);box-shadow:0 12px 36px rgba(0,0,0,.45)}

  @media (max-width:560px){ .grid2{grid-template-columns:1fr} }
</style>
</head>
<body>
  <div class="wrap">
    <div class="title">LEGEND OF YMIR DIAMOND üíé</div>

    <div class="logoWrap">
      <div class="logo" id="secretLogo" title="(Secret)">
        <div class="ring"></div>
        <img src="logo.png" alt="Logo">
      </div>
    </div>

    <!-- Owner (under logo) -->
    <div class="owner">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="#1877f2" aria-hidden="true">
        <path d="M22 12.07C22 6.48 17.52 2 11.93 2S2 6.48 2 12.07c0 5.01 3.66 9.17 8.44 9.93v-7.02H7.9v-2.91h2.54V9.41c0-2.5 1.49-3.89 3.77-3.89 1.09 0 2.24.2 2.24.2v2.46 h-1.26c-1.24 0-1.63.77-1.63 1.56v1.87h2.78l-.44 2.91h-2.34V22c4.78-.76 8.44-4.92 8.44-9.93z"/>
      </svg>
      <a href="https://www.facebook.com/share/1FWLHh32iE/" target="_blank" rel="noopener">
        <span class="ownerName">MOISEES TRAJANO BITONIO</span>
        <svg class="metaBadge" viewBox="0 0 24 24" aria-hidden="true">
          <defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#2aa4ff"/><stop offset="1" stop-color="#1877f2"/></linearGradient></defs>
          <circle cx="12" cy="12" r="10" fill="url(#g)"/>
          <path d="M9.2 12.6l-1.7-1.7a1 1 0 10-1.4 1.4l2.4 2.4c.4.4 1 .4 1.4 0l6.1-6.1a1 1 0 10-1.4-1.4l-5.4 5.4z" fill="#fff"/>
        </svg>
      </a>
    </div>

    <!-- Tiers -->
    <div class="row prices">
      <div id="pill80" class="pill">
        <div class="pval">‚Ç±800</div>
        <div class="ptxt">per 1,000 ‚Ä¢ min 1,000 üíé</div>
      </div>
      <div id="pill75" class="pill">
        <div class="pval">‚Ç±750</div>
        <div class="ptxt">per 1,000 ‚Ä¢ min 4,000 üíé</div>
      </div>
      <div id="pill70" class="pill">
        <div class="pval">‚Ç±700</div>
        <div class="ptxt">per 1,000 ‚Ä¢ min 8,000 üíé</div>
        <div class="dealChip" aria-hidden="true">üî• BEST DEAL</div>
      </div>
    </div>

    <!-- Inputs -->
    <div class="section">
      <div class="label">Enter Diamonds üíé</div>
      <input id="dias" class="in" inputmode="numeric" autocomplete="off" placeholder="e.g. 1500">

      <div class="label" style="margin-top:10px">ENTER PHP ‚Ç±</div>
      <input id="phpIn" class="in" inputmode="decimal" autocomplete="off" placeholder="e.g. 800.00">

      <div class="label" style="margin-top:10px">Server (Required)</div>
      <input id="serverIn" class="in" placeholder="Type exact server (e.g., ASIA-022 / HOF1)" autocomplete="off">
      <div class="hint">Make sure tama ang server name para iwas delay sa drop.</div>

      <div id="warn" class="warn">Minimum 1,000 üíé and Server are required.</div>

      <div class="grid2">
        <div class="box">
          <h5>Rate</h5>
          <div id="rateOut" class="rateOut">‚Äî</div>
        </div>
        <div class="box saveBox">
          <h5>Save</h5>
          <div id="saveOut" class="saveOut">‚Äî</div>
        </div>
      </div>
    </div>

    <!-- Buy -->
    <button id="buyBtn" type="button" class="btn buy" disabled>üíé Buy</button>
    <div class="label" style="text-align:center;margin-top:8px">Enter at least 1,000 dias, then type your server.</div>

    <!-- Stock quick view (no hint text shown) -->
    <div style="display:flex;justify-content:center;margin:10px 0 12px">
      <div id="stockChip" class="stockChip" title="Stocks">
        <span id="stockIcon" aria-hidden="true">üì¶</span>
        <strong style="margin-left:6px">Total Stock:</strong>&nbsp;<span id="stockTotal">‚Äî</span> üíé
        <span class="badge" id="stockHint"></span>
      </div>
    </div>

    <!-- Payment + Socials -->
    <div class="pay">
      <!-- GCash (copy only) with QR button -->
      <div id="gcashRow" class="gcashRow" title="Tap to copy number">
        <div class="gcashLeft">
          <div class="gcashIcon">G</div>
          GCash ‚Ä¢ <strong id="gcashNumber">09162466318 ‚Äî MOISES B.</strong>
        </div>
        <button id="showQR" type="button" class="qrBtn" title="Show GCash QR">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="#cfe4ff" aria-hidden="true">
            <path d="M3 3h8v8H3V3zm2 2v4h4V5H5zm6 6h8v8h-8v-8zm2 2v4h4v-4h-4zM3 13h8v8H3v-8zm2 2v4h4v-4H5zm12-12h4v4h-4V3z"/>
          </svg>
          Show QR
        </button>
      </div>

      <!-- GoTyme (copy only) with QR button) -->
      <div id="goRow" class="gcashRow" title="Tap to copy account" style="background:rgba(0,214,231,.08);border-color:rgba(0,214,231,.35)">
        <div class="gcashLeft">
          <svg width="26" height="26" viewBox="0 0 32 32" aria-hidden="true"
               style="border-radius:999px; box-shadow:0 0 10px rgba(0,214,231,.35)">
            <defs>
              <linearGradient id="goTeal" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0" stop-color="#00D6E7"/>
                <stop offset="1" stop-color="#00BFD3"/>
              </linearGradient>
            </defs>
            <rect x="0" y="0" width="32" height="32" rx="16" fill="url(#goTeal)"/>
            <path d="M10.5 16a5.5 5.5 0 1 1 11 0 5.5 5.5 0 0 1-11 0zm2.6 0a2.9 2.9 0 1 0 5.8 0 2.9 2.9 0 0 0-5.8 0z" fill="#00353A" opacity=".95"/>
          </svg>
          GoTyme ‚Ä¢ <strong id="goNumber">014664932955 ‚Äî MOISES BITONIO</strong>
        </div>
        <button id="showGoQR" type="button" class="qrBtn" title="Show GoTyme QR" style="background:rgba(0,214,231,.14);border-color:rgba(0,214,231,.45);color:#d6fffe">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="#d6fffe" aria-hidden="true">
            <path d="M3 3h8v8H3V3zm2 2v4h4V5H5zm6 6h8v8h-8v-8zm2 2v4h4v-4h-4zM3 13h8v8H3v-8zm2 2v4h4v-4H5zm12-12h4v4h-4V3z"/>
          </svg>
          Show QR
        </button>
      </div>

      <div class="soc">
        <a class="btnlink fb" href="https://www.facebook.com/share/p/17MiaRJ24J/" target="_blank" rel="noopener">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="#fff" aria-hidden="true">
            <path d="M22 12.07C22 6.48 17.52 2 11.93 2S2 6.48 2 12.07c0 5.01 3.66 9.17 8.44 9.93v-7.02H7.9v-2.91h2.54V9.41c0-2.5 1.49-3.89 3.77-3.89 1.09 0 2.24.2 2.24.2v2.46 h-1.26c-1.24 0-1.63.77-1.63 1.56v1.87h2.78l-.44 2.91h-2.34V22c4.78-.76 8.44-4.92 8.44-9.93z"/>
          </svg>
          FACEBOOK FEEDBACK
        </a>
        <a class="btnlink dc" href="https://discord.gg/QkdVz5mh" target="_blank" rel="noopener">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="#fff" aria-hidden="true">
            <path d="M20.3 4.4A16 16 0 0015.9 3l-.4.8a13.3 13.3 0 00-7 0L8.1 3A16 16 0 003.7 4.4C1.7 7.5 1 10.5 1.2 13.4a16 16 0 005.9 3l.8-1.3c-.4-.1-.7-.3-1-.4.1-.1.2-.2.3-.3 1.9.9 4 .9 5.9 0l.3.3c-.3.2-.6.3-1 .4l.8 1.3a16 16 0 005.9-3c.3-3-.5-5.9-2.8-9zM9.6 13c-.9 0-1.6-.8-1.6-1.7S8.7 9.6 9.6 9.6s1.6.8 1.6 1.7S10.5 13 9.6 13zm4.8 0c-.9 0-1.6-.8-1.6-1.7s.7-1.7 1.6-1.7 1.6.8 1.6 1.7-.7 1.7-1.6 1.7z"/>
          </svg>
          DISCORD FEEDBACK
        </a>
      </div>
    </div>

    <!-- Waiting Time Notice -->
    <div class="notice">
      <h4>‚è≥ Waiting Time Notice</h4>
      <p>Processing time may vary depending on server demand. Some servers might experience longer wait times ‚Äî pero <strong>guaranteed matatanggap ang order mo</strong>.</p>
    </div>

    <!-- Track Order -->
    <div class="track">
      <div class="label" style="margin-bottom:6px">Track Order</div>
      <div style="display:grid;grid-template-columns:1fr auto;gap:10px">
        <input id="trackIn" class="in" placeholder="Enter Receipt ID (e.g., YMIR-XXXX)" autocomplete="off">
        <button id="trackBtn" class="btn" style="background:#27252c;color:#fff">Check</button>
      </div>
      <div id="trackOut" style="margin-top:10px;display:none">
        <div class="chip" style="margin-bottom:8px">
          <strong id="t_id">‚Äî</strong>
          <span id="t_status" style="opacity:.9"></span>
        </div>
        <div style="display:grid;gap:6px;font-size:14px;color:#ccb9c1">
          <div>Server: <span id="t_server" style="color:#fff"></span></div>
          <div>Diamonds: <span id="t_qty" style="color:#fff"></span> üíé</div>
          <div>Rate: <span id="t_rate" style="color:#fff"></span></div>
          <div>Total: <span id="t_total" style="color:#fff"></span></div>
          <div>Created: <span id="t_time" style="color:#fff"></span></div>
        </div>
        <div style="display:flex;gap:8px;margin-top:10px;flex-wrap:wrap">
          <button id="btnPaid" class="btn" style="background:#204c2f;color:#e7fff1">Buyer: I Paid</button>
        </div>
        <div class="hint" style="margin-top:6px">
          Tip: Buyer taps <b>I Paid</b> after sending payment. (Local tracking only)
        </div>
      </div>
      <div id="trackNone" class="hint" style="display:none;margin-top:8px">Walang record sa device na ‚Äôto. Note: Tracking works on the same phone/browser (local only).</div>
    </div>
  </div>

  <!-- BUY Popup -->
  <div id="buyPopup">
    <div class="cardPop">
      <h3>Copied ‚úî</h3>
      <p id="buyMsg"><strong>PAALALA:</strong> May lalabas na Messenger pagkatapos ng <b id="countDown">15</b>s.<br>I-paste mo doon ang nakopya mong order message at <b>isend kay MOISES TRAJANO BITONIO</b>.</p>
      <div id="buyOrderId" style="margin:10px 0 6px;font-weight:800"></div>
      <button id="closePop" class="btn" style="background:#272327;color:#fff;width:160px;margin:auto">OK</button>
    </div>
  </div>

  <!-- GCash Copied Popup -->
  <div id="gcashPopup">
    <div class="cardPop">
      <h3>GCash number copied ‚úî</h3>
      <p><strong>09162466318 ‚Äî MOISES B.</strong><br>Paste sa GCash Express Send.</p>
      <button id="gcashOk" class="btn" style="background:#272327;color:#fff;width:160px;margin:auto">OK</button>
    </div>
  </div>

  <!-- GCash QR Popup -->
  <div id="qrPopup">
    <div class="cardPop">
      <h3>GCash QR</h3>
      <p>Scan to pay ‚Ä¢ <strong>MOISES B.</strong></p>
      <img src="gcash-qr.png" alt="GCash QR" class="qrImg">
      <div style="margin-top:12px">
        <button id="qrOk" class="btn" style="background:#272327;color:#fff;width:160px;margin:auto">Close</button>
      </div>
    </div>
  </div>

  <!-- Stock by Server Modal -->
  <div id="stockModal">
    <div class="stockCard" role="dialog" aria-modal="true" aria-labelledby="stockTitle">
      <div class="stockHead">
        <h3 id="stockTitle">YMIR Server Stocks (Gold/üíé)</h3>
        <div class="stockTools" style="flex:1">
          <div class="stockSearch" style="flex:1">
            üîé <input id="srvSearch" type="search" placeholder="Search server‚Ä¶ (e.g., ASIA-022 / HOF1)">
          </div>
          <span id="adminState" class="badge"></span>
          <button id="btnCloseStock" class="btnTiny btnGhost" type="button">Close</button>
        </div>
      </div>
      <div id="stockBody" class="stockBody" role="document">
        <div id="stockList"></div>
      </div>
      <div class="stockFoot">
        <button id="btnAddServer" class="btnTiny btnGhost" type="button" title="Add new server">+ Add server</button>
        <button id="btnSaveStock" class="btnTiny btnPri" type="button" disabled>Save changes</button>
      </div>
    </div>
  </div>

<script>
(function(){
  /* ====== Helpers ====== */
  const $ = id => document.getElementById(id);
  const clean = v => String(v ?? '').replace(/[^\d.]/g,'');
  const toInt = v => { const m = clean(v).match(/^\d+/); return m? parseInt(m[0],10):0; };
  const toNum = v => { const m = clean(v).match(/^\d+(?:\.\d+)?/); return m? parseFloat(m[0]):0; };
  const fmt = n => Number(n).toLocaleString(undefined,{minimumFractionDigits:2, maximumFractionDigits:2});
  const nowISO = () => new Date().toISOString().replace('T',' ').slice(0,19);

  const MIN = 1000;
  /* Rates are PHP PER 1,000 diamonds */
  const TIERS = [
    {min:8000, rate:700},
    {min:4000, rate:750},
    {min:1000, rate:800}
  ];
  const BASE_REF = 900; // for "Save" comparison, PHP per 1,000

  /* ====== Elements ====== */
  const diasIn = $('dias'), phpIn = $('phpIn'), serverIn = $('serverIn');
  const rateOut = $('rateOut'), saveOut = $('saveOut'), warn = $('warn');
  const buyBtn = $('buyBtn'), buyPopup = $('buyPopup'), closePop = $('closePop'), buyOrderId = $('buyOrderId');
  const countDownEl = $('countDown');
  const gcashRow = $('gcashRow'), gcashPopup = $('gcashPopup'), gcashOk = $('gcashOk');
  const showQR = $('showQR'), qrPopup = $('qrPopup'), qrOk = $('qrOk');

  /* ====== Stock els ====== */
  const stockChip=$('stockChip'), stockIcon=$('stockIcon'), stockTotalEl=$('stockTotal');
  const stockModal=$('stockModal'), stockList=$('stockList'), adminState=$('adminState');
  const btnCloseStock=$('btnCloseStock'), btnSaveStock=$('btnSaveStock'), btnAddServer=$('btnAddServer'), srvSearch=$('srvSearch');

  /* ====== Storage Keys ====== */
  const STOCK_KEY='ymir_stock_by_server';
  const ORDERS_KEY='ymir_orders_map';

  /* ====== State ====== */
  let adminMode=false, dirty=false, filter='';
  let tap5=0, tapTimer=null;
  let tap6=0, tap6Timer=null;

  /* ====== Init stock map & defaults ====== */
  const defaultServers = [
    ...Array.from({length:30},(_,i)=>`ASIA-${String(i+1).padStart(3,'0')}`),
    'HOF1','HOF2','HOF3','HOF4','HOF5'
  ];
  let stockMap = loadStock();

  function loadStock(){
    try{
      const raw=localStorage.getItem(STOCK_KEY);
      let obj= raw? JSON.parse(raw): {};
      if(!obj || typeof obj!=='object') obj={};
      defaultServers.forEach(s=>{ if(!(s in obj)) obj[s]=0; });
      if(!raw) localStorage.setItem(STOCK_KEY, JSON.stringify(obj));
      renderTotals();
      return obj;
    }catch(_){
      const obj = Object.fromEntries(defaultServers.map(s=>[s,0]));
      localStorage.setItem(STOCK_KEY, JSON.stringify(obj));
      renderTotals();
      return obj;
    }
  }
  function saveStock(){
    try{ localStorage.setItem(STOCK_KEY, JSON.stringify(stockMap)); }catch(_){}
    renderTotals();
  }
  function renderTotals(){
    const total = Object.values(stockMap).reduce((a,b)=>a+(parseInt(b,10)||0),0);
    stockTotalEl.textContent = total.toLocaleString();
  }

  /* ====== Orders Map ====== */
  function loadOrders(){
    try{ return JSON.parse(localStorage.getItem(ORDERS_KEY)||'{}'); }catch(_){ return {}; }
  }
  function saveOrders(map){ try{ localStorage.setItem(ORDERS_KEY, JSON.stringify(map)); }catch(_){} }

  /* ====== Rate utils ====== */
  function getRate(qty){
    if(!qty || qty<MIN) return null;
    for(const t of TIERS){ if(qty>=t.min) return t.rate; }
    return null;
  }

  function recalcFromDias(){
    const q = toInt(diasIn.value);
    const r = getRate(q);
    if(!r){
      rateOut.textContent='‚Äî'; saveOut.textContent='‚Äî';
    }else{
      rateOut.textContent = `‚Ç±${r.toFixed(0)} / 1,000`;
      const total = (q/1000)*r;
      const save = Math.max(0, (q/1000)*(BASE_REF - r));
      saveOut.textContent = `‚Ç±${fmt(save)}`;
    }
    validate();
  }

  function recalcFromPHP(){
    const p = toNum(phpIn.value);
    if(!p){ validate(); return; }
    let bestQ=0, bestR=null;
    for(const t of TIERS){
      const q = Math.floor((p / t.rate) * 1000); // qty in diamonds
      if(q>=t.min && q>bestQ){ bestQ=q; bestR=t.rate; }
    }
    if(bestQ>=MIN && bestR){
      diasIn.value = String(bestQ);
      rateOut.textContent = `‚Ç±${bestR.toFixed(0)} / 1,000`;
      const save = Math.max(0, (bestQ/1000)*(BASE_REF - bestR));
      saveOut.textContent = `‚Ç±${fmt(save)}`;
    }
    validate();
  }

  /* ====== Validation ====== */
  function validate(){
    const q = toInt(diasIn.value), s = (serverIn.value||'').trim();
    const ok = q>=MIN && !!s;
    warn.style.display = ok ? 'none' : 'block';
    buyBtn.disabled = !ok;
  }

  diasIn.addEventListener('input', recalcFromDias);
  phpIn.addEventListener('input', recalcFromPHP);
  serverIn.addEventListener('input', validate);

  /* ====== GCash UI ====== */
  gcashRow.addEventListener('click', ()=>{
    const num = $('gcashNumber').innerText;
    navigator.clipboard?.writeText(num).catch(()=>{});
    gcashPopup.style.display='grid';
  });
  gcashOk.addEventListener('click', ()=> gcashPopup.style.display='none');
  showQR.addEventListener('click', ()=> qrPopup.style.display='grid');
  qrOk.addEventListener('click', ()=> qrPopup.style.display='none');

  /* ====== Buy flow (15s popup + redirect to Messenger) ====== */
  const buyMsg = $('buyMsg');
  const secretLogo = $('secretLogo');

  buyBtn.addEventListener('click', ()=>{
    const qty = toInt(diasIn.value);
    const srv = (serverIn.value||'').trim();
    const rate = getRate(qty);
    if(!rate) return;

    const totalPhp = (qty/1000)*rate;
    const id = 'YMIR-' + Date.now().toString(36).toUpperCase();

    // Save order locally
    const orders = loadOrders();
    orders[id] = {
      id, qty, server: srv, rate, total: totalPhp,
      status: 'Pending', created: nowISO()
    };
    saveOrders(orders);

    // Copy message
    const msg = [
      `ORDER: ${id}`,
      `Server: ${srv}`,
      `Diamonds: ${qty} üíé`,
      `Rate: ‚Ç±${rate.toFixed(0)}/1,000`,
      `Total: ‚Ç±${fmt(totalPhp)}`,
      `Buyer: I Paid (after sending)`
    ].join('\n');
    navigator.clipboard?.writeText(msg).catch(()=>{});

    // Popup + countdown + redirect
    $('buyOrderId').textContent = id;
    buyPopup.style.display='grid';
    let t = 15;
    countDownEl.textContent = String(t);
    const iv = setInterval(()=>{
      t--; countDownEl.textContent = String(t);
      if(t<=0){ clearInterval(iv); window.location.href = 'https://m.me/mbitonio'; }
    },1000);

    closePop.onclick = ()=>{ clearInterval(iv); buyPopup.style.display='none'; };
  });

  /* ====== Tracking ====== */
  const trackBtn=$('trackBtn'), trackIn=$('trackIn'), trackOut=$('trackOut'), trackNone=$('trackNone');
  const t_id=$('t_id'), t_status=$('t_status'), t_server=$('t_server'), t_qty=$('t_qty'), t_rate=$('t_rate'), t_total=$('t_total'), t_time=$('t_time');
  const btnPaid=$('btnPaid');

  function renderTrack(o){
    if(!o){ trackOut.style.display='none'; trackNone.style.display='block'; return; }
    trackNone.style.display='none'; trackOut.style.display='block';
    t_id.textContent=o.id||'‚Äî'; t_status.textContent=`‚Ä¢ ${o.status||'‚Äî'}`;
    t_server.textContent=o.server||'‚Äî'; t_qty.textContent=(o.qty||0).toLocaleString();
    t_rate.textContent=o.rate?`‚Ç±${o.rate.toFixed(0)}/1,000`:'‚Äî';
    t_total.textContent=o.total?`‚Ç±${fmt(o.total)}`:'‚Äî';
    t_time.textContent=o.created||'‚Äî';
  }

  trackBtn.addEventListener('click', ()=>{
    const id = (trackIn.value||'').trim();
    const map = loadOrders();
    renderTrack(map[id]);
  });
  btnPaid.addEventListener('click', ()=>{
    const id=(t_id.textContent||'').trim();
    if(!id) return;
    const map=loadOrders(); if(!map[id]) return;
    map[id].status='Buyer Paid';
    saveOrders(map);
    renderTrack(map[id]);
    alert('Status set to "Buyer Paid"');
  });

  /* ====== Secret "Delivered" (6 taps on round logo) with auto-deduct ====== */
  let tap6=0, tap6Timer=null;
  function onLogoTap(){
    tap6++;
    clearTimeout(tap6Timer);
    tap6Timer=setTimeout(()=>tap6=0,1200);
    if(tap6>=6){
      tap6=0;
      const id=prompt('Enter Order ID to mark DELIVERED:');
      if(!id) return;
      const map=loadOrders();
      const o=map[id];
      if(!o){ alert('Order not found.'); return; }
      if(o.status==='Delivered'){ alert('Already delivered.'); return; }
      // Auto-deduct
      const srv=o.server;
      const have= parseInt(stockMap[srv]||0,10);
      const newVal = Math.max(0, have - (parseInt(o.qty,10)||0));
      stockMap[srv] = newVal;
      saveStock();

      o.status='Delivered';
      saveOrders(map);
      alert('Marked Delivered. Stock auto-deducted ‚úî');
      if(($('t_id').textContent||'')===id){ renderTrack(o); }
    }
  }
  secretLogo.addEventListener('click', onLogoTap);

  /* ====== Stock modal (view + admin via 5 taps on üì¶, no text shown) ====== */
  function openStock(readOnly=true){
    stockModal.style.display='grid';
    adminMode = !readOnly;
    adminState.textContent = adminMode ? '' : ''; // hide
    dirty=false; btnSaveStock.disabled=true;
    filter=''; if(srvSearch) srvSearch.value='';
    renderStockList();
  }
  function closeStock(){ stockModal.style.display='none'; }

  function renderStockList(){
    stockList.innerHTML='';
    const names = Object.keys(stockMap)
      .sort((a,b)=>a.localeCompare(b,'en',{numeric:true,sensitivity:'base'}))
      .filter(n => !filter || n.toLowerCase().includes(filter.toLowerCase()));

    if(!names.length){
      const d=document.createElement('div');
      d.style.cssText='padding:20px;text-align:center;color:#ccb9c1';
      d.textContent='No servers found.';
      stockList.appendChild(d); return;
    }

    names.forEach(name=>{
      const row=document.createElement('div'); row.className='srvRow';

      let nameCell;
      if(adminMode){
        nameCell=document.createElement('div');
        const nameInput = document.createElement('input');
        nameInput.className='nameEdit';
        nameInput.value=name;
        nameCell.appendChild(nameInput);

        const renameBtn=document.createElement('button');
        renameBtn.className='btnTiny btnGhost';
        renameBtn.textContent='Rename';
        renameBtn.onclick=()=>{
          const newName=(nameInput.value||'').trim();
          if(!newName || newName===name) return;
          if(stockMap[newName]!=null) return alert('Name already exists.');
          stockMap[newName]=stockMap[name]; delete stockMap[name];
          dirty=true; btnSaveStock.disabled=false;
          renderTotals(); renderStockList();
        };
        nameCell.appendChild(renameBtn);
      }else{
        const h=document.createElement('h4'); h.textContent=name; nameCell=h;
      }

      let countCell;
      if(adminMode){
        countCell=document.createElement('div'); countCell.className='srvCnt edit';
        const input=document.createElement('input');
        input.type='number'; input.min='0'; input.step='1'; input.value=String(stockMap[name]||0);
        input.addEventListener('input', ()=>{
          stockMap[name]=Math.max(0, parseInt(input.value||'0',10)||0);
          dirty=true; btnSaveStock.disabled=false; renderTotals();
        });
        countCell.appendChild(input);
      }else{
        countCell=document.createElement('div'); countCell.className='srvCnt';
        countCell.textContent=(stockMap[name]||0).toLocaleString();
      }

      const act=document.createElement('div'); act.style.cssText='text-align:right;display:flex;gap:8px;justify-content:flex-end';
      if(adminMode){
        const del=document.createElement('button'); del.className='btnTiny btnGhost'; del.textContent='Remove';
        del.onclick=()=>{
          if(confirm(`Remove server "${name}"?`)){
            delete stockMap[name]; dirty=true; btnSaveStock.disabled=false;
            renderTotals(); renderStockList();
          }
        };
        act.appendChild(del);
      }

      row.appendChild(nameCell);
      row.appendChild(countCell);
      row.appendChild(act);
      stockList.appendChild(row);
    });
  }

  stockChip.addEventListener('click', ()=> openStock(true));

  let tap5=0, tapTimer=null;
  stockIcon.addEventListener('click', (e)=>{
    e.stopPropagation();
    tap5++; clearTimeout(tapTimer);
    tapTimer=setTimeout(()=>tap5=0,1200);
    if(tap5>=5){
      tap5=0;
      openStock(false); // admin mode
    }
  });
  btnCloseStock.addEventListener('click', closeStock);
  btnSaveStock.addEventListener('click', ()=>{ saveStock(); dirty=false; btnSaveStock.disabled=true; alert('Stocks saved ‚úî'); });
  btnAddServer.addEventListener('click', ()=>{
    if(!adminMode) return alert('Open Admin mode first (tap üì¶ 5x).');
    const name=prompt('New server name (e.g., ASIA-031 or HOF6):'); if(!name) return;
    const key=name.trim(); if(!/^[\w\-]+$/i.test(key)) return alert('Invalid server name.');
    if(stockMap[key]!=null) return alert('Server already exists.');
    const qty=Math.max(0, parseInt(prompt('Initial stock (gold/üíé):')||'0',10)||0);
    stockMap[key]=qty; dirty=true; btnSaveStock.disabled=false; renderTotals(); renderStockList();
  });
  srvSearch.addEventListener('input', ()=>{ filter=srvSearch.value||''; renderStockList(); });

  /* ====== Init ====== */
  renderTotals();
})();
</script>
</body>
</html>